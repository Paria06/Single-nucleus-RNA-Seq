rm(list = ls(all = T))
cat("\014")
setwd("/Users/paria/OneDrive/Rsession/")
base_path <- "/Users/paria/OneDrive/Rsession/"

# Load libraries
library(dplyr)
library(ggplot2)


#  Read in the DEG sets
base_path <- "/Users/paria/OneDrive/Rsession/"

directories <- c("ocumed_cluster" = "DEG/interaction_med_vs_ocu/cluster/",
                 "ocumed_main" = "DEG/interaction_med_vs_ocu/main/",
                 "ocusc_cluster" = "DEG/interaction_sc_vs_ocu/cluster/",
                 "ocusc_main" = "DEG/interaction_sc_vs_ocu/main/",
                 "ocusl_cluster" = "DEG/interaction_sl_vs_ocu/cluster/",
                 "ocusl_main" = "DEG/interaction_sl_vs_ocu/main/")

for(directory_name in names(directories)) {
  
  directory <- directories[[directory_name]]
  data <- read_csv(file = paste0(base_path, directory, "2_filtered_results.csv"))

plotdata <- data %>%
  filter(padj < 0.05) %>%
  select(log2FoldChange, padj, cluster_id) %>%
  mutate(pval_cat = cut(padj, breaks = 0.01*c(0:5), labels = 0.01*c(1:5)))

pdf(file = paste0(base_path, 'Finalized_outputs/', directory_name, 'log2foldchange_pointplot.pdf'), width = 8, height = 6)
plotdata %>%
  ggplot(aes(x = log2FoldChange, y = cluster_id, color = padj)) +
  geom_point(size = 2) +
  geom_vline(xintercept = 0) +
  theme_classic() +
  scale_colour_steps(n.breaks = 4, guide = 'legend') +
  ggtitle(label = "Title", subtitle = "Subtitle") +
  labs(color = "p-value")
dev.off()
}

sessionInfo()
